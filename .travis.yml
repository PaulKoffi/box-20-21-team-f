language: generic

jobs:
  include:
      - stage: "Tests"
        name: "Building all docker images"
        before_install:
          - chmod +x build.sh
          - chmod +x docker/CLIs/elon/build.sh
          - chmod +x docker/CLIs/tory/build.sh
          - chmod +x docker/CLIs/richard/build.sh
          - chmod +x docker/rpc/pollCreator/build.sh
          - chmod +x docker/services/rocketInventory/build.sh
          - chmod +x docker/services/weather/build.sh
          - chmod +x clean.sh
          - chmod +x run.sh
          - chmod +x stop.sh
        script: ./build.sh
      - name: "Launch all docker containers"
        script: ./run.sh
      - name: "Units tests of rocket service"
        before_install:
          - "pip install -U pip"
          - "export PYTHONPATH=$PYTHONPATH:$(pwd)"
        install: 
          - pip install -r requirements.txt
        script:
          - python services/rocketInventory/test/rocketApiTest.py
      - name: "Stop all docker containers"
        script: ./stop.sh
      - name: "Remove all images"
        script: ./clean.sh
